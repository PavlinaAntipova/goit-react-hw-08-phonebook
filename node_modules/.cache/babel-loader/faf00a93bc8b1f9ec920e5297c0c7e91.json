{"ast":null,"code":"import _asyncToGenerator from\"/Users/pashtet/Documents/GitHub/goit-react-hw-08-phonebook/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/pashtet/Documents/GitHub/goit-react-hw-08-phonebook/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import{createAsyncThunk}from'@reduxjs/toolkit';axios.defaults.baseURL='https://connections-api.herokuapp.com';var token={set:function set(token){axios.defaults.headers.common.Authorization=\"Bearer \".concat(token);},unset:function unset(){axios.defaults.headers.common.Authorization='';}};export var registration=createAsyncThunk('auth/registration',/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user,thunkAPI){var _yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post('/users/signup',user);case 3:_yield$axios$post=_context.sent;data=_yield$axios$post.data;token.set(data.token);return _context.abrupt(\"return\",data);case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);return _context.abrupt(\"return\",thunkAPI.rejectWithValue());case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function(_x,_x2){return _ref.apply(this,arguments);};}());export var login=createAsyncThunk('auth/login',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(user,thunkAPI){var _yield$axios$post2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post('/users/login',user);case 3:_yield$axios$post2=_context2.sent;data=_yield$axios$post2.data;token.set(data.token);return _context2.abrupt(\"return\",data);case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);return _context2.abrupt(\"return\",thunkAPI.rejectWithValue());case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9]]);}));return function(_x3,_x4){return _ref2.apply(this,arguments);};}());export var logout=createAsyncThunk('auth/logout',/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_,thunkAPI){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.post('/users/logout');case 3:token.unset();_context3.next=9;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);return _context3.abrupt(\"return\",thunkAPI.rejectWithValue());case 9:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function(_x5,_x6){return _ref3.apply(this,arguments);};}());export var refresh=createAsyncThunk('auth/refresh',/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(_,thunkAPI){var state,persistedToken,_yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:state=thunkAPI.getState();persistedToken=state.auth.token;if(!(persistedToken===null)){_context4.next=4;break;}return _context4.abrupt(\"return\",thunkAPI.rejectWithValue());case 4:token.set(persistedToken);_context4.prev=5;_context4.next=8;return axios.get('/users/current');case 8:_yield$axios$get=_context4.sent;data=_yield$axios$get.data;return _context4.abrupt(\"return\",data);case 13:_context4.prev=13;_context4.t0=_context4[\"catch\"](5);return _context4.abrupt(\"return\",thunkAPI.rejectWithValue());case 16:case\"end\":return _context4.stop();}}},_callee4,null,[[5,13]]);}));return function(_x7,_x8){return _ref4.apply(this,arguments);};}());","map":{"version":3,"sources":["/Users/pashtet/Documents/GitHub/goit-react-hw-08-phonebook/src/redux/auth/auth-operations.js"],"names":["axios","createAsyncThunk","defaults","baseURL","token","set","headers","common","Authorization","unset","registration","user","thunkAPI","post","data","console","log","rejectWithValue","login","logout","_","refresh","state","getState","persistedToken","auth","get"],"mappings":"mSAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,gBAAT,KAAiC,kBAAjC,CAEAD,KAAK,CAACE,QAAN,CAAeC,OAAf,CAAyB,uCAAzB,CAEA,GAAMC,CAAAA,KAAK,CAAG,CACZC,GADY,cACRD,KADQ,CACD,CACTJ,KAAK,CAACE,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,kBAAwDJ,KAAxD,EACD,CAHW,CAIZK,KAJY,iBAIJ,CACNT,KAAK,CAACE,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,CAA8C,EAA9C,CACD,CANW,CAAd,CASA,MAAO,IAAME,CAAAA,YAAY,CAAGT,gBAAgB,CAAC,mBAAD,0FAAsB,iBAAOU,IAAP,CAAaC,QAAb,mLAEnCZ,CAAAA,KAAK,CAACa,IAAN,CAAW,eAAX,CAA4BF,IAA5B,CAFmC,wCAElDG,IAFkD,mBAElDA,IAFkD,CAG1DV,KAAK,CAACC,GAAN,CAAUS,IAAI,CAACV,KAAf,EAH0D,gCAInDU,IAJmD,0DAM1DC,OAAO,CAACC,GAAR,cAN0D,gCAOpDJ,QAAQ,CAACK,eAAT,EAPoD,sEAAtB,mEAArC,CAWP,MAAO,IAAMC,CAAAA,KAAK,CAAGjB,gBAAgB,CAAC,YAAD,2FAAe,kBAAOU,IAAP,CAAaC,QAAb,0LAEvBZ,CAAAA,KAAK,CAACa,IAAN,CAAW,cAAX,CAA2BF,IAA3B,CAFuB,0CAEtCG,IAFsC,oBAEtCA,IAFsC,CAGhDV,KAAK,CAACC,GAAN,CAAUS,IAAI,CAACV,KAAf,EAHgD,iCAIzCU,IAJyC,8FAMrCF,QAAQ,CAACK,eAAT,EANqC,wEAAf,qEAA9B,CAUP,MAAO,IAAME,CAAAA,MAAM,CAAGlB,gBAAgB,CAAC,aAAD,2FAAgB,kBAAOmB,CAAP,CAAUR,QAAV,8JAEzCZ,CAAAA,KAAK,CAACa,IAAN,CAAW,eAAX,CAFyC,QAG9CT,KAAK,CAACK,KAAN,GAH8C,mHAKzCG,QAAQ,CAACK,eAAT,EALyC,uEAAhB,qEAA/B,CASP,MAAO,IAAMI,CAAAA,OAAO,CAAGpB,gBAAgB,CACrC,cADqC,2FAErC,kBAAOmB,CAAP,CAAUR,QAAV,qKACQU,KADR,CACgBV,QAAQ,CAACW,QAAT,EADhB,CAEQC,cAFR,CAEyBF,KAAK,CAACG,IAAN,CAAWrB,KAFpC,MAIMoB,cAAc,GAAK,IAJzB,4DAKWZ,QAAQ,CAACK,eAAT,EALX,SAOIb,KAAK,CAACC,GAAN,CAAUmB,cAAV,EAPJ,wCAU2BxB,CAAAA,KAAK,CAAC0B,GAAN,CAAU,gBAAV,CAV3B,wCAUYZ,IAVZ,kBAUYA,IAVZ,kCAWWA,IAXX,gGAaWF,QAAQ,CAACK,eAAT,EAbX,yEAFqC,qEAAhC","sourcesContent":["import axios from \"axios\";\nimport { createAsyncThunk } from '@reduxjs/toolkit';\n\naxios.defaults.baseURL = 'https://connections-api.herokuapp.com';\n\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = '';\n  },\n};\n\nexport const registration = createAsyncThunk('auth/registration', async (user, thunkAPI) => {\n    try {\n        const { data } = await axios.post('/users/signup', user);\n        token.set(data.token);\n        return data;\n    } catch (error) {\n        console.log(error);\n       return thunkAPI.rejectWithValue();\n    }\n});\n\nexport const login = createAsyncThunk('auth/login', async (user, thunkAPI) => {\n    try {\n      const { data } = await axios.post('/users/login', user);\n    token.set(data.token);\n    return data;\n    } catch (error) {\n        return thunkAPI.rejectWithValue();\n    }\n});\n\nexport const logout = createAsyncThunk('auth/logout', async (_, thunkAPI) => {\n    try {\n       await axios.post('/users/logout');\n        token.unset();\n    } catch (error) {\n      return thunkAPI.rejectWithValue();\n    }\n});\n\nexport const refresh = createAsyncThunk(\n  'auth/refresh',\n  async (_, thunkAPI) => {\n    const state = thunkAPI.getState();\n    const persistedToken = state.auth.token;\n\n    if (persistedToken === null) {\n      return thunkAPI.rejectWithValue();\n    }\n      token.set(persistedToken);\n      \n    try {\n      const { data } = await axios.get('/users/current');\n      return data;\n    } catch (error) {\n      return thunkAPI.rejectWithValue();\n    }\n  },\n);\n\n\n\n"]},"metadata":{},"sourceType":"module"}